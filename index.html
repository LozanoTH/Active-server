<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Login Firebase</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding-top: 50px; }
        form { display: flex; flex-direction: column; gap: 10px; width: 300px; }
        input, button { padding: 10px; }
    </style>
</head>
<body>

    <form id="login-form">
        <h2>Iniciar Sesi칩n</h2>
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Contrase침a" required>
        <button type="submit" id="btn-login">Entrar</button>
    </form>

    <script type="module">
        import { auth, signInWithEmailAndPassword } from './firebase-config.js';
        import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const loginForm = document.getElementById('login-form');

        // 1. Redirigir al Home si ya hay una sesi칩n activa
        onAuthStateChanged(auth, (user) => {
            if (user) window.location.href = 'home.html';
        });

        // 2. L칩gica de Login
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const btn = document.getElementById('btn-login');

            try {
                btn.disabled = true;
                btn.innerText = "Cargando...";
                await signInWithEmailAndPassword(auth, email, password);
                window.location.href = "home.html";
            } catch (error) {
                btn.disabled = false;
                btn.innerText = "Entrar";
                alert("Error: " + error.code);
            }
        });
    </script>
</body>
</html>